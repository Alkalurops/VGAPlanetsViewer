// Generated by CoffeeScript 1.3.3
(function() {
  var CheckBoxView, PlanetView, SearchView, SliderView, View,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  View = (function() {

    View.prototype.subviews = [];

    function View(element) {
      this.element = element;
      if (!(element != null)) {
        element = "DIV";
      }
      if (typeof element === "string") {
        this.element = document.createElement(element);
      } else {
        this.element = element;
      }
      this.element.isView = true;
      document.body.appendChild(this.element);
      this.subviews = [];
      this.render();
    }

    View.prototype.update = function() {
      return this.render();
    };

    View.prototype.render = function() {};

    View.prototype.addSubview = function(aView) {
      if (__indexOf.call(this.subviews, aView) >= 0) {
        return aView;
      }
      this.subviews.push(aView);
      return this.element.appendChild(aView.element);
    };

    return View;

  })();

  SliderView = (function(_super) {

    __extends(SliderView, _super);

    function SliderView(func) {
      SliderView.__super__.constructor.call(this, 'input');
      this.element.type = 'range';
      this.element.min = 0.5;
      this.element.max = 5;
      this.element.step = 0.001;
      this.element.onchange = func;
      this.element.value = 1.0;
    }

    SliderView.prototype.value = function(value) {
      this.element.value = 1.0 * value;
      return this.element.onchange();
    };

    return SliderView;

  })(View);

  SearchView = (function(_super) {

    __extends(SearchView, _super);

    function SearchView() {
      return SearchView.__super__.constructor.apply(this, arguments);
    }

    return SearchView;

  })(View);

  SearchView = (function(_super) {

    __extends(SearchView, _super);

    function SearchView(func) {
      var label;
      SearchView.__super__.constructor.call(this, 'input');
      this.element.type = 'search';
      this.element.onkeyup = function(event) {
        if (event.keyCode === 13) {
          return func(event);
        }
      };
      label = document.createElement("label");
    }

    return SearchView;

  })(View);

  CheckBoxView = (function(_super) {

    __extends(CheckBoxView, _super);

    function CheckBoxView(title, func) {
      var label;
      CheckBoxView.__super__.constructor.call(this, 'input');
      this.element.type = 'checkbox';
      this.element.checked = false;
      this.element.onchange = func;
      label = document.createElement("label");
    }

    return CheckBoxView;

  })(View);

  PlanetView = (function(_super) {

    __extends(PlanetView, _super);

    PlanetView.prototype.planetNames = [];

    PlanetView.prototype.planetCoordinates = [];

    PlanetView.prototype.canvas = null;

    PlanetView.prototype.scale = 1.0;

    PlanetView.prototype.maxDistance = 84.5;

    PlanetView.prototype.dimension = [4000, 4000];

    PlanetView.prototype.offset = [0, 0];

    PlanetView.prototype.drawsLines = false;

    PlanetView.prototype.lineColor = 'rgba(0,255,255,0.25)';

    PlanetView.prototype.planetColor = 'white';

    PlanetView.prototype.textColor = 'cyan';

    function PlanetView(slider) {
      var lastEvent, mouseIsDown,
        _this = this;
      this.fetchPlanetNames();
      this.fetchPlanetCoordinates();
      PlanetView.__super__.constructor.call(this);
      this.slider = slider;
      this.element.appendChild((this.canvas = document.createElement("canvas")));
      this.canvas.width = document.body.clientWidth;
      window.addEventListener("resize", function(event) {
        _this.canvas.width = document.body.clientWidth - 100;
        return _this.update();
      });
      this.canvas.height = 800;
      this.canvas.style.cursor = "move";
      mouseIsDown = false;
      lastEvent = null;
      this.canvas.addEventListener("mousedown", function(event) {
        mouseIsDown = true;
        return lastEvent = event;
      });
      this.canvas.addEventListener("mouseup", function(event) {
        mouseIsDown = false;
        return lastEvent = null;
      });
      this.canvas.addEventListener("mousewheel", function(event) {
        var newValue;
        if (event.wheelDelta > 0) {
          newValue = _this.scale + 0.1;
        } else {
          newValue = _this.scale - 0.1;
        }
        return _this.slider.value(newValue);
      });
      this.canvas.addEventListener("mousemove", function(event) {
        if (mouseIsDown) {
          _this.mouseDragged(event, lastEvent);
          return lastEvent = event;
        }
      });
      this.image = new Image();
      this.image.onload = function() {
        return _this.update();
      };
      this.image.src = "data:image/png;base64,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";
    }

    PlanetView.prototype.mouseDragged = function(event, lastEvent) {
      var x, y;
      x = (event.clientX - lastEvent.clientX) * (1 / this.scale);
      y = (event.clientY - lastEvent.clientY) * (1 / this.scale);
      this.offset = [this.offset[0] + x, this.offset[1] + y];
      this.constrainOffset();
      return this.update();
    };

    PlanetView.prototype.constrainOffset = function() {
      if (this.offset[0] < -2000) {
        this.offset[0] = -2000;
      }
      if (this.offset[1] < -2000) {
        this.offset[1] = -2000;
      }
      if (this.offset[0] > 2000) {
        this.offset[0] = 2000;
      }
      if (this.offset[1] > 2000) {
        this.offset[1] = 2000;
      }
      if (window.isNaN(this.offset[1])) {
        this.offset[1] = 0;
      }
      if (window.isNaN(this.offset[0])) {
        return this.offset[0] = 0;
      }
    };

    PlanetView.prototype.center = function(coordinate) {
      this.offset[0] = 2000 - coordinate[0];
      this.offset[1] = coordinate[1] - 2000;
      this.constrainOffset();
      return this.update();
    };

    PlanetView.prototype.searchPlanet = function(planetName) {
      var coord, index, _i, _ref;
      if (!(planetName != null)) {
        return;
      }
      coord;

      for (index = _i = 0, _ref = this.planetNames.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; index = 0 <= _ref ? ++_i : --_i) {
        if (this.planetNames[index].toLowerCase().indexOf(planetName.toLowerCase()) !== -1) {
          coord = this.planetCoordinates[index];
          break;
        }
      }
      if (coord != null) {
        return this.center(coord);
      }
    };

    PlanetView.prototype.setScale = function(newScale) {
      this.scale = parseFloat(newScale);
      return this.update();
    };

    PlanetView.prototype.appendText = function(text) {
      var element;
      element = document.createElement("div");
      this.element.appendChild(element);
      text = document.createTextNode(text);
      return element.appendChild(text);
    };

    PlanetView.prototype.render = function() {
      var context;
      if (this.planetNames.length !== 500) {
        return false;
      }
      if (this.planetCoordinates.length !== 500) {
        return false;
      }
      context = this.canvas.getContext('2d');
      context.fillStyle = 'rgba(0,0,0,1)';
      context.fillRect(0, 0, this.canvas.width, this.canvas.height);
      if (this.drawsLines) {
        this.drawLines(context);
      }
      return this.drawPlanets(context);
    };

    PlanetView.prototype.drawPlanets = function(context) {
      var i, _i, _ref, _results;
      _results = [];
      for (i = _i = 0, _ref = this.planetNames.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
        _results.push(this.drawPlanet(context, i));
      }
      return _results;
    };

    PlanetView.prototype.generateLines = function() {
      var coord1, coord2, distance, index1, index2, lines, upperBound, _i, _j;
      distance = function(coord1, coord2) {
        var d, square;
        square = function(x) {
          return x * x;
        };
        d = Math.sqrt(square(coord2[0] - coord1[0]) + square(coord2[1] - coord1[1]));
        return d;
      };
      lines = [];
      upperBound = this.planetCoordinates.length - 1;
      for (index1 = _i = 0; 0 <= upperBound ? _i <= upperBound : _i >= upperBound; index1 = 0 <= upperBound ? ++_i : --_i) {
        for (index2 = _j = index1; index1 <= upperBound ? _j <= upperBound : _j >= upperBound; index2 = index1 <= upperBound ? ++_j : --_j) {
          coord1 = this.planetCoordinates[index1];
          coord2 = this.planetCoordinates[index2];
          if (distance(coord1, coord2) < this.maxDistance) {
            lines.push([coord1, coord2]);
          }
        }
      }
      this.lines = lines;
      return this.update();
    };

    PlanetView.prototype.drawLines = function(context) {
      var line, _i, _len, _ref, _results;
      if (!(this.lines != null)) {
        this.generateLines();
      }
      _ref = this.lines;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        line = _ref[_i];
        _results.push(this.drawLine(context, line));
      }
      return _results;
    };

    PlanetView.prototype.scaleCoordinates = function(coord) {
      var x, y;
      x = 4000 - Math.round((coord[0] - this.offset[0]) * this.scale) - this.canvas.width / 2;
      y = 4000 - Math.round((coord[1] - this.offset[1]) * this.scale) - this.canvas.height / 2;
      x = (coord[0] - (this.dimension[0] / 2) + this.offset[0]) * this.scale + this.canvas.width / 2;
      y = (4000 - coord[1] - (this.dimension[1] / 2) + this.offset[1]) * this.scale + this.canvas.height / 2;
      return [x, y];
    };

    PlanetView.prototype.drawPlanet = function(context, nr) {
      var coord, name, nameAdjustment, scaledCoord, x, y;
      coord = this.planetCoordinates[nr];
      name = this.planetNames[nr];
      scaledCoord = this.scaleCoordinates(coord);
      x = scaledCoord[0];
      y = scaledCoord[1];
      if (!((this.canvas.width > x && x > 0))) {
        return;
      }
      if (!((this.canvas.height > y && y > 0))) {
        return;
      }
      if (this.scale < 1.5) {
        context.fillStyle = this.planetColor;
        this.drawCircle(context, x, y);
      } else {
        this.drawPlanetImage(context, x, y);
      }
      context.fillStyle = this.textColor;
      nameAdjustment = context.measureText(name).width / 2;
      return context.fillText(name, x - nameAdjustment, y + 12 + (1 * this.scale));
    };

    PlanetView.prototype.drawPlanetImage = function(context, x, y) {
      var height, width;
      this.image;
      width = 1 + 4 * this.scale;
      height = 1 + 4 * this.scale;
      return context.drawImage(this.image, x - (width / 2), y - (height / 2), width, height);
    };

    PlanetView.prototype.drawLine = function(context, line) {
      var coord1, coord2, _ref, _ref1, _ref2, _ref3;
      coord1 = this.scaleCoordinates(line[0]);
      coord2 = this.scaleCoordinates(line[1]);
      if (!(((this.canvas.width + this.maxDistance > (_ref = coord1[0]) && _ref > (0 - this.maxDistance))) || ((this.canvas.width + this.maxDistance > (_ref1 = coord2[0]) && _ref1 > (0 - this.maxDistance))) || ((this.canvas.height + this.maxDistance > (_ref2 = coord1[1]) && _ref2 > (0 - this.maxDistance))) || ((this.canvas.height + this.maxDistance > (_ref3 = coord2[1]) && _ref3 > (0 - this.maxDistance))))) {
        return;
      }
      context.lineWidth = 1;
      context.strokeStyle = this.lineColor;
      context.beginPath();
      context.moveTo(coord1[0], coord1[1]);
      context.lineTo(coord2[0], coord2[1]);
      return context.stroke();
    };

    PlanetView.prototype.drawCircle = function(context, left, right) {
      var circleSize;
      circleSize = 2;
      context.beginPath();
      context.arc(left - (circleSize / 2), right - (circleSize / 2), circleSize, 0, Math.PI * 2, true);
      context.closePath();
      return context.fill();
    };

    PlanetView.prototype.fetchPlanetNames = function() {
      var self, xhr;
      self = this;
      xhr = new XMLHttpRequest();
      xhr.open('GET', 'PLANET.NM', true);
      xhr.overrideMimeType = 'text/plain; charset=x-user-defined';
      xhr.responseType = 'text';
      xhr.onload = function(event) {
        var planetName;
        return self.didFetchPlanetNames((function() {
          var _i, _len, _ref, _results;
          _ref = this.response.match(/.{1,20}/g);
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            planetName = _ref[_i];
            _results.push(planetName.trimRight());
          }
          return _results;
        }).call(this));
      };
      xhr.onerror = function(event) {
        return console.log(event);
      };
      return xhr.send();
    };

    PlanetView.prototype.didFetchPlanetNames = function(names) {
      this.planetNames = names;
      return this.update();
    };

    PlanetView.prototype.fetchPlanetCoordinates = function() {
      var self, xhr;
      self = this;
      xhr = new XMLHttpRequest();
      xhr.open('GET', 'XYPLAN.DAT', true);
      xhr.overrideMimeType = 'text/plain; charset=x-user-defined';
      xhr.responseType = 'arraybuffer';
      xhr.onload = function(event) {
        return self.didFetchPlanetCoordinates(new Uint8Array(this.response));
      };
      xhr.onerror = function(event) {
        return console.log(event);
      };
      return xhr.send();
    };

    PlanetView.prototype.didFetchPlanetCoordinates = function(coordinates) {
      var i, n, x, x1, x2, y, y1, y2, _i;
      this.planetCoordinates = [];
      i = 0;
      for (n = _i = 1; _i <= 500; n = ++_i) {
        x1 = coordinates[i];
        x2 = coordinates[i + 1] * 256;
        x = x1 + x2;
        y1 = coordinates[i + 2];
        y2 = coordinates[i + 3] * 256;
        y = y1 + y2;
        this.planetCoordinates.push([x, y]);
        i = i + 6;
      }
      return this.update();
    };

    PlanetView.prototype.shouldDrawLines = function(shouldDraw) {
      this.drawsLines = shouldDraw;
      return this.update();
    };

    return PlanetView;

  })(View);

  window.ready = function() {
    var checker, planetView, searcher, slider;
    planetView = null;
    slider = new SliderView(function() {
      return planetView.setScale(slider.element.value);
    });
    checker = new CheckBoxView('show warp-routes', function() {
      return planetView.shouldDrawLines(checker.element.checked);
    });
    searcher = new SearchView(function(even) {
      return planetView.searchPlanet(searcher.element.value);
    });
    return planetView = new PlanetView(slider);
  };

}).call(this);
